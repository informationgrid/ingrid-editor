<div fxLayout="column" fxFill>
    <!-- Toolbar -->
    <form-toolbar></form-toolbar>

    <as-split [useTransition]="true" (dragEnd)="rememberSizebarWidth($event)" [gutterSize]="12">

        <!-- exchangable sidebar -->
        <as-split-area [size]="sidebarWidth" id="sidebar">
            <ige-sidebar [address]="address" [activeId]="activeId" (dropped)="handleDrop($event)"></ige-sidebar>
        </as-split-area>

        <!-- The form -->
        <as-split-area #scrollForm [size]="100-sidebarWidth" id="form" class="form-content">

            <div *ngIf="isLoading" class="loading">
                <div>Lade Dokument ...</div>
                <mat-spinner [diameter]="30"></mat-spinner>
            </div>

            <ng-container *ngIf="!isLoading">

                <ng-content *ngIf="fields.length === 0"></ng-content>

                <ng-container *ngIf="fields.length !== 0">
                    <ige-form-info [form]="form"
                                   [model]="model"
                                   [forAddress]="address"
                                   [sections]="sections"
                                   [parentContainer]="scrollForm"
                                   (showStickyHeader)="updateContentPadding($event)"></ige-form-info>
                    <div [class.hide]="!hasOptionalFields" class="optional-fields-toggle">
                        <div class="diagonal"></div>
                        <mat-slide-toggle checked (change)="toggleOptionals($event)">Alle</mat-slide-toggle>
                    </div>
                    <form [formGroup]="form"
                          [style.padding-top]="paddingWithHeader"
                          [class.hide-validation]="!showValidationErrors"
                          [class.hide]="model._type === 'FOLDER'">
                        <div class="note-mandatory">*Pflichtfeld</div>
                        <formly-form [form]="form" [fields]="fields" [model]="model" [options]="formOptions"></formly-form>

                        <!--<pre>
        JSON:
        {{model | json}}
                        </pre>-->
                    </form>

                    <div *ngIf="model._type === 'FOLDER'" class="folder-content">
                        <ige-folder-dashboard [isAddress]="address" [parentId]="activeId | async"></ige-folder-dashboard>
                    </div>
                </ng-container>

            </ng-container>

        </as-split-area>

        <as-split-area *ngIf="showJson">
            Form is dirty: {{ form.dirty }} valid: {{form.valid}}
            <pre>
{{model | json}}
           </pre>

        </as-split-area>

    </as-split>
</div>
