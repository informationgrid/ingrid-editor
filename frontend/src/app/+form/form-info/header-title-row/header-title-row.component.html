<div class="title flex-row" *transloco="let t">
    <ige-document-icon [doc]="_model"></ige-document-icon>

    <span
        *ngIf="!showTitleInput"
        class="label flex-1"
        [matTooltip]="
            t(
                'form.titleTooltip.' +
                    (_model.firstName ? 'Person' : 'Organisation')
            )
        "
        [matTooltipDisabled]="!address || !disableEdit"
        [matTooltipShowDelay]="1000"
        [class.editable]="!disableEdit"
        (click)="!disableEdit && editTitle()"
    >
        <span>{{ _form.get("title")?.value || "Kein Titel" }}</span>
        <mat-icon svgIcon="cursor-edit" matTooltip="Bearbeiten"></mat-icon>
    </span>

    <form [formGroup]="_form" [class.hide]="!showTitleInput">
        <mat-form-field appearance="outline">
            <textarea
                #cfcAutosize="cdkTextareaAutosize"
                #titleInput
                matInput
                formControlName="title"
                cdkTextareaAutosize
                cdkAutosizeMinRows="1"
                cdkAutosizeMaxRows="5"
                (blur)="showTitleInput = false"
                (keyup.enter)="showTitleInput = false"
                (keydown.enter)="$event.preventDefault()"
            >
            </textarea>
        </mat-form-field>
    </form>

    <button
        mat-icon-button
        data-cy="btn-more-header"
        class="dark menu-button btn-toggle-form-header"
        [matTooltip]="showMore ? 'Schließen' : 'Öffnen'"
        [class.expanded]="showMore"
        (click)="toggleMoreInfo()"
    >
        <mat-icon class="rotating animated">keyboard_arrow_down</mat-icon>
    </button>
    <button
        *ngIf="showMoreActions && moreActions.length"
        data-cy="more-actions"
        mat-icon-button
        class="menu dark menu-button"
        [matMenuTriggerFor]="moreActionsMenu"
        matTooltip="Bearbeiten"
    >
        <mat-icon svgIcon="Mehr"></mat-icon>
        <mat-menu #moreActionsMenu="matMenu">
            <button
                [attr.data-cy]="'action-' + action.name"
                mat-menu-item
                *ngFor="let action of moreActions"
                (click)="action.action()"
                [disabled]="action.disabled"
            >
                {{ action.title }}
            </button>
        </mat-menu>
    </button>
</div>

<ige-header-more [showMore]="showMore" [model]="_model"></ige-header-more>
