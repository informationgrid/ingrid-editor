<div class="title" *transloco="let t">
    <div class="document-type">
        <mat-icon
            [matTooltip]="t('procedureType.' + _model._type)"
            [svgIcon]="icon"
            [ngClass]="['document-icon', stateClass]"
        ></mat-icon>
    </div>

    <!-- TODO: move profile specific text to localisation file -->
    <span
        *ngIf="!showTitleInput"
        fxFlex
        class="label"
        [matTooltip]="
            _model._type === 'UvpOrganisationDoc' ||
            _model._type === 'McloudAddressDoc'
                ? 'Der Titel der Adresse ergibt sich aus dem Feld Bezeichnung.'
                : 'Der Titel der Adresse ergibt sich aus den Feldern Nachname und/oder Vorname.'
        "
        [matTooltipDisabled]="!address || !disableEdit"
        [matTooltipShowDelay]="1000"
        [class.editable]="!disableEdit"
        (click)="!disableEdit && editTitle()"
    >
        <span>{{ _form.get("title")?.value || "Kein Titel" }}</span>
        <mat-icon svgIcon="cursor-edit"></mat-icon>
    </span>

    <form [formGroup]="_form" [class.hide]="!showTitleInput">
        <mat-form-field appearance="outline">
            <textarea
                #cfcAutosize="cdkTextareaAutosize"
                #titleInput
                matInput
                formControlName="title"
                cdkTextareaAutosize
                cdkAutosizeMinRows="1"
                cdkAutosizeMaxRows="5"
                (blur)="showTitleInput = false"
                (keyup.enter)="showTitleInput = false"
                (keydown.enter)="$event.preventDefault()"
            >
            </textarea>
        </mat-form-field>
    </form>

    <button
        mat-icon-button
        class="dark menu-button"
        [class.expanded]="showMore"
        (click)="toggleMoreInfo()"
    >
        <mat-icon class="rotating animated">keyboard_arrow_down</mat-icon>
    </button>
    <button
        *ngIf="showMoreActions && _model._type !== 'FOLDER'"
        data-cy="more-actions"
        mat-icon-button
        class="menu dark menu-button"
        [matMenuTriggerFor]="moreActionsMenu"
    >
        <mat-icon svgIcon="Mehr"></mat-icon>
        <mat-menu #moreActionsMenu="matMenu">
            <button
                [attr.data-cy]="'action-' + action.name"
                mat-menu-item
                *ngFor="let action of moreActions"
                (click)="action.action()"
            >
                {{ action.title }}
            </button>
        </mat-menu>
    </button>
</div>

<ige-header-more [showMore]="showMore" [model]="_model"></ige-header-more>
