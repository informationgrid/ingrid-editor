<page-template title="Katalogspezifische Codelisten">
    <ng-container help>
        Sie haben hier die Möglichkeit bestehende Codelisten anzupassen. Diese Änderungen sind nur in diesem Katalog
        sichtbar. Wenn diese Änderungen auch in anderen Katalogen oder im Portal verwendet werden sollen, dann muss
        dies im Codelist-Repository geschehen.

        <div *ngIf="showSavedState" class="save-info">Codeliste wurde eben gespeichert</div>
    </ng-container>

    <div main fxLayout="column" fxFlex>
        <p *ngIf="(hasCatalogCodelists | async) === false">
            In diesem Katalog gibt es keine spezifischen Codelisten. Alle Codelisten können
            über das zentrale Codelist-Repository verwaltet werden.
        </p>

        <div fxLayout="row">
            <!--<ige-filter-select #select [options]="catalogCodelists" fxFlex class="white-bg"
                               [labelFormat]="codelistLabelFormat" (optionSelect)="selectCodelist($event)"
                               placeholder="Codeliste"></ige-filter-select>-->
            <mat-form-field appearance="outline" class="width-100 white-bg">
                <mat-select #select (selectionChange)="selectCodelist($event.value)" [value]="initialValue">
                    <mat-option *ngFor="let codelist of catalogCodelists | async" [value]="codelist">
                        {{codelist.label}} ({{codelist.value}})
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <div class="reset-button">
                <button mat-button mat-stroked-button
                        (click)="resetCodelist()">Zurücksetzen
                </button>
            </div>
        </div>

        <ng-container *ngIf="(hasCatalogCodelists | async) === true">

            <div *ngIf="selectedCodelist" class="entries-container">

                <mat-form-field appearance="outline" class="width-100 white-bg">
                    <mat-label>Beschreibung</mat-label>
                    <textarea matInput name="description" [formControl]="descriptionCtrl"></textarea>
                </mat-form-field>

                <div>
                    <div fxFlex></div>
                    <button mat-flat-button color="primary" (click)="addCodelist()">Hinzufügen</button>
                </div>
                <mat-list class="hover-list">
                    <mat-list-item *ngFor="let entry of selectedCodelist.entries">
                        <mat-icon mat-list-icon>list</mat-icon>
                        <p mat-line class="identifier">
                            {{entry.id}}
                        </p>
                        <p mat-line class="codelist-title">
                            {{entry.fields['de']}}
                        </p>
                        <!--<p mat-line *ngIf="entry.data">
                            {{entry.data}}
                        </p>-->
                        <div fxFlex></div>

                        <button mat-icon-button class="menu-button" [matMenuTriggerFor]="codelistMenu">
                            <mat-icon svgIcon="Mehr"></mat-icon>
                        </button>
                        <mat-menu #codelistMenu="matMenu">
                            <button mat-menu-item (click)="editCodelist(entry)">
                                Bearbeiten
                            </button>
                            <button mat-menu-item (click)="removeCodelist(entry)">
                                Löschen
                            </button>
                        </mat-menu>

                        <mat-divider></mat-divider>

                    </mat-list-item>
                </mat-list>
            </div>
        </ng-container>
    </div>

</page-template>
