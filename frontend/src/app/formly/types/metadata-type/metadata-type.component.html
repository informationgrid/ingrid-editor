{{ aForm.getRawValue() | json }}

<div [attr.data-cy]="key" [formGroup]="aForm">
    @for (option of displayedOptions(); track option) {
        <div class="flex-row small-label-width">
            <ige-form-label>{{ option.label }}</ige-form-label>

            <div class="flex-row align-items-center option-row">
                @for (typeOption of option.typeOptions; track typeOption) {
                    @if (!typeOption.hidden) {
                        @if (typeOption.key === undefined) {
                            @for (
                                item of typeOption.items;
                                track item;
                                let isLast = $last
                            ) {
                                {{ item.hide }}
                                <mat-chip-listbox
                                    [formControlName]="item.key"
                                    [hideSingleSelectionIndicator]="true"
                                    [required]="true"
                                    ><mat-chip-option
                                        [value]="item.value"
                                        [disabled]="
                                            props.disabledOptions[item.key]
                                        "
                                        (click)="handleOptionClick(item)"
                                        >{{ item.label }}</mat-chip-option
                                    ></mat-chip-listbox
                                >
                            }
                        } @else {
                            <mat-chip-listbox
                                [multiple]="typeOption.multiple"
                                [hideSingleSelectionIndicator]="true"
                                [formControlName]="typeOption.key"
                                (change)="handleChange(typeOption, $event)"
                            >
                                @for (
                                    item of typeOption.items;
                                    track item;
                                    let isLast = $last
                                ) {
                                    <!--                                @if (!item.hide) {-->
                                    <mat-chip-option
                                        [value]="item.value"
                                        [disabled]="
                                            props.disabledOptions[
                                                typeOption.key
                                            ]
                                        "
                                        (click)="handleOptionClick(item)"
                                        >{{ item.label }}</mat-chip-option
                                    >
                                    @if (!typeOption.multiple && !isLast) {
                                        <span
                                            class="connector"
                                            [class.comment]="
                                                props.disabledOptions[
                                                    typeOption.key
                                                ]
                                            "
                                            >oder</span
                                        >
                                    }
                                    <!--                                }-->
                                }
                            </mat-chip-listbox>
                        }
                    }
                }
            </div>
        </div>
    }
</div>
